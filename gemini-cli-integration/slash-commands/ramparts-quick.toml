# Ramparts Quick Security Check Command
# File: ~/.gemini/commands/ramparts-quick.toml or .gemini/commands/ramparts-quick.toml

description = "Quick security health check of MCP servers - fast assessment for immediate feedback"

prompt = """
I need a quick security health check for immediate feedback.

Target: {{args}}

Please perform a rapid security assessment with these priorities:

1. **Quick Scan Execution**:
   
   Based on target type:
   - If empty or "config": `ramparts scan-config --format json`
   - If URL provided: `ramparts scan "{{args}}" --format json`
   - If "all": Scan both config and any specified URLs
   
   Focus on speed - get basic security status quickly.

2. **Immediate Risk Identification**:
   
   **ğŸš¨ CRITICAL ALERTS** (Show immediately if found):
   - Command injection vulnerabilities
   - Path traversal attacks (../../../etc/passwd)
   - SQL injection risks
   - Authentication bypass issues
   - Secrets exposure (API keys, tokens, passwords)
   
   **âš ï¸ HIGH PRIORITY WARNINGS**:
   - Tool poisoning (misleading tool descriptions)
   - Cross-origin escalation risks
   - Unsafe file operations
   - Privilege escalation potential

3. **Security Status Summary**:
   
   Provide clear, immediate status indication:
   
   **âœ… SECURE STATUS:**
   ```
   ğŸ›¡ï¸ SECURITY STATUS: GOOD
   â€¢ No critical vulnerabilities detected
   â€¢ No high-priority security issues
   â€¢ MCP servers appear secure for use
   â€¢ Last scanned: [timestamp]
   ```
   
   **âš ï¸ CAUTION STATUS:**
   ```
   âš ï¸ SECURITY STATUS: NEEDS ATTENTION  
   â€¢ [X] medium-priority issues detected
   â€¢ No critical vulnerabilities found
   â€¢ Review recommended within 7 days
   â€¢ Issues: [brief list]
   ```
   
   **ğŸš¨ URGENT STATUS:**
   ```
   ğŸš¨ SECURITY STATUS: CRITICAL ISSUES FOUND
   â€¢ [X] critical vulnerabilities detected
   â€¢ [X] high-priority security risks
   â€¢ IMMEDIATE ACTION REQUIRED
   â€¢ Do not use in production until fixed
   ```

4. **Quick Action Items**:
   
   **If CRITICAL issues found:**
   - ğŸ›‘ **STOP**: Do not use these MCP servers in production
   - ğŸ”§ **FIX**: [List specific critical fixes needed]
   - âœ… **VERIFY**: Re-scan after fixes: `/ramparts-quick [target]`
   
   **If HIGH issues found:**
   - â° **SCHEDULE**: Plan remediation within 24-48 hours
   - ğŸ” **DETAIL**: Run full audit: `/ramparts-audit`
   - ğŸ“‹ **TRACK**: Monitor for exploitation attempts
   
   **If MEDIUM/LOW issues found:**
   - ğŸ“… **PLAN**: Include in next security review cycle
   - ğŸ“Š **BASELINE**: Document current security posture
   - ğŸ”„ **MONITOR**: Set up regular scanning schedule

5. **Next Steps Recommendation**:
   
   Based on findings, suggest immediate next actions:
   
   **For SECURE status:**
   - âœ… Continue using MCP servers safely
   - ğŸ“… Schedule next security check in 30 days
   - ğŸ”” Set up monitoring alerts for changes
   
   **For CAUTION status:**
   - ğŸ“‹ Review medium-priority issues when convenient
   - ğŸ” Consider running full audit: `/ramparts-audit`
   - ğŸ“Š Establish security baseline and monitoring
   
   **For URGENT status:**
   - ğŸš¨ Address critical issues immediately
   - ğŸ›‘ Disable vulnerable MCP servers until fixed
   - ğŸ”§ Get detailed remediation steps: `/ramparts-scan [specific-server]`
   - âœ… Verify fixes with re-scan

6. **Quick Security Tips**:
   
   **ğŸ›¡ï¸ Immediate Security Improvements:**
   - Always validate MCP server sources
   - Use authentication headers where possible
   - Limit MCP server permissions to minimum required
   - Regularly update MCP server configurations
   - Monitor MCP server activity and logs

**Keep this assessment concise, actionable, and focused on immediate security concerns. Prioritize speed and clarity over comprehensive analysis.**

Execute the quick security check now and provide immediate feedback.
"""